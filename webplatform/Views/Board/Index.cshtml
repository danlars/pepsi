@using webplatform.Models
@model Board
@{
    ViewBag.Title = String.Format("Opgaver for {0}", Model.name);
    List<Card> cards = (List<Card>)ViewData["Cards"];
    List<Job> jobs = (List<Job>)ViewData["Jobs"];
    int highestCardWeight = cards.OrderByDescending(x => x.weight_id).FirstOrDefault().weight_id;
    List<int> jobIds = new List<int>();
}


<div class="row">

    <div class="col-md-12">
        <h2>@ViewBag.Title</h2>
    </div>

    <div class="col-md-12" id="content">

        @foreach (var job in jobs.Where(x => x.board_id == Model.id).OrderBy(x => x.weight_id))
        {
            <ul class="list-group job pull-left borderless">

                <li class="list-group-item item-header">
                    <h3 class="list-group-item-heading">
                        @job.title
                    </h3>
                </li>
                <div class="list-items">
                    @foreach (var card in cards.Where(x => x.job_id == job.id))
                    {
                        <li class="list-group-item feet">
                            <h5 class="list-group-item-heading">
                                @card.title
                            </h5>
                            <p class="list-group-item-text">
                                @card.description
                            </p>
                        </li>
                    }
                </div>
            </ul>
        }
    </div>
</div>
@section scripts
{
    <script>
        $(document).ready(function() {

            $(".list-items").sortable({
                revert: true
            });

            $(".feet").draggable({
                connectToSortable: ".list-items",
                revert: "invalid"
            });

            $("ul, li").disableSelection();

            $(".item-header").mousedown(function () {
                $("#content").sortable({ revert: true });
            });
        });
    </script>
}

